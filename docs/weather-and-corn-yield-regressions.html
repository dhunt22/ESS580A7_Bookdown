<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Weather and Corn Yield Regressions | ESS 580A7 Introduction to Environmental Data Science Project Compilation</title>
  <meta name="description" content="A compilation of modules applying various packages and skills in R." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Weather and Corn Yield Regressions | ESS 580A7 Introduction to Environmental Data Science Project Compilation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A compilation of modules applying various packages and skills in R." />
  <meta name="github-repo" content="dhunt22/ESS580A7_Bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Weather and Corn Yield Regressions | ESS 580A7 Introduction to Environmental Data Science Project Compilation" />
  
  <meta name="twitter:description" content="A compilation of modules applying various packages and skills in R." />
  

<meta name="author" content="Devin Hunt" />


<meta name="date" content="2022-03-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lake-water-quality-analysis.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.0/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.0/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ESS 580A7 Introduction to Environmental Data Science Project Compilation</a></li>

<li class="divider"></li>
<li><a href="index.html#preface">Preface<span></span></a></li>
<li class="chapter" data-level="1" data-path="discharge-data-example.html"><a href="discharge-data-example.html"><i class="fa fa-check"></i><b>1</b> Discharge Data Example<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="discharge-data-example.html"><a href="discharge-data-example.html#site-description"><i class="fa fa-check"></i><b>1.1</b> Site Description<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="discharge-data-example.html"><a href="discharge-data-example.html#data-acquisition-and-plotting-tests"><i class="fa fa-check"></i><b>1.2</b> Data Acquisition and Plotting tests<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="discharge-data-example.html"><a href="discharge-data-example.html#data-download"><i class="fa fa-check"></i><b>1.3</b> Data Download<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="discharge-data-example.html"><a href="discharge-data-example.html#static-data-plotter"><i class="fa fa-check"></i><b>1.4</b> Static Data Plotter<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="discharge-data-example.html"><a href="discharge-data-example.html#interactive-data-plotter"><i class="fa fa-check"></i><b>1.5</b> Interactive Data Plotter<span></span></a></li>
<li class="chapter" data-level="1.6" data-path="discharge-data-example.html"><a href="discharge-data-example.html#assignment"><i class="fa fa-check"></i><b>1.6</b> Assignment<span></span></a></li>
<li class="chapter" data-level="1.7" data-path="discharge-data-example.html"><a href="discharge-data-example.html#dygraph-example."><i class="fa fa-check"></i><b>1.7</b> DyGraph example.<span></span></a></li>
<li class="chapter" data-level="1.8" data-path="discharge-data-example.html"><a href="discharge-data-example.html#poudre-paragraph"><i class="fa fa-check"></i><b>1.8</b> Poudre Paragraph<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html"><i class="fa fa-check"></i><b>2</b> Hayman Fire Recovery<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#question-1"><i class="fa fa-check"></i><b>2.1</b> Question 1)<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#question-2"><i class="fa fa-check"></i><b>2.2</b> Question 2<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#q3"><i class="fa fa-check"></i><b>2.3</b> Q3<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#question-4"><i class="fa fa-check"></i><b>2.4</b> Question 4<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#question-5"><i class="fa fa-check"></i><b>2.5</b> Question 5)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="snow-data-assignment-web-scraping-functions-and-iteration.html"><a href="snow-data-assignment-web-scraping-functions-and-iteration.html"><i class="fa fa-check"></i><b>3</b> Snow Data Assignment: Web Scraping, Functions, and Iteration<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="snow-data-assignment-web-scraping-functions-and-iteration.html"><a href="snow-data-assignment-web-scraping-functions-and-iteration.html#reading-an-html"><i class="fa fa-check"></i><b>3.1</b> Reading an html<span></span></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="snow-data-assignment-web-scraping-functions-and-iteration.html"><a href="snow-data-assignment-web-scraping-functions-and-iteration.html#extract-csv-links-from-webpage"><i class="fa fa-check"></i><b>3.1.1</b> Extract CSV links from webpage<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="snow-data-assignment-web-scraping-functions-and-iteration.html"><a href="snow-data-assignment-web-scraping-functions-and-iteration.html#data-download-1"><i class="fa fa-check"></i><b>3.2</b> Data Download<span></span></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="snow-data-assignment-web-scraping-functions-and-iteration.html"><a href="snow-data-assignment-web-scraping-functions-and-iteration.html#download-data-in-a-for-loop"><i class="fa fa-check"></i><b>3.2.1</b> Download data in a for loop<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="snow-data-assignment-web-scraping-functions-and-iteration.html"><a href="snow-data-assignment-web-scraping-functions-and-iteration.html#download-data-in-a-map"><i class="fa fa-check"></i><b>3.2.2</b> Download data in a map<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="snow-data-assignment-web-scraping-functions-and-iteration.html"><a href="snow-data-assignment-web-scraping-functions-and-iteration.html#data-read-in"><i class="fa fa-check"></i><b>3.3</b> Data read-in<span></span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="snow-data-assignment-web-scraping-functions-and-iteration.html"><a href="snow-data-assignment-web-scraping-functions-and-iteration.html#read-in-just-the-snow-data-as-a-loop"><i class="fa fa-check"></i><b>3.3.1</b> Read in just the snow data as a loop<span></span></a></li>
<li class="chapter" data-level="3.3.2" data-path="snow-data-assignment-web-scraping-functions-and-iteration.html"><a href="snow-data-assignment-web-scraping-functions-and-iteration.html#read-in-the-data-as-a-map-function"><i class="fa fa-check"></i><b>3.3.2</b> Read in the data as a map function<span></span></a></li>
<li class="chapter" data-level="3.3.3" data-path="snow-data-assignment-web-scraping-functions-and-iteration.html"><a href="snow-data-assignment-web-scraping-functions-and-iteration.html#plot-snow-data"><i class="fa fa-check"></i><b>3.3.3</b> Plot snow data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="snow-data-assignment-web-scraping-functions-and-iteration.html"><a href="snow-data-assignment-web-scraping-functions-and-iteration.html#assignment-1"><i class="fa fa-check"></i><b>3.4</b> Assignment:<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html"><i class="fa fa-check"></i><b>4</b> LAGOS Spatial Analysis<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#loading-in-data"><i class="fa fa-check"></i><b>4.1</b> Loading in data<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#first-download-and-then-specifically-grab-the-locus-or-site-lat-longs"><i class="fa fa-check"></i><b>4.1.1</b> First download and then specifically grab the locus (or site lat longs)<span></span></a></li>
<li class="chapter" data-level="4.1.2" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#convert-to-spatial-data"><i class="fa fa-check"></i><b>4.1.2</b> Convert to spatial data<span></span></a></li>
<li class="chapter" data-level="4.1.3" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#subset-to-only-minnesota"><i class="fa fa-check"></i><b>4.1.3</b> Subset to only Minnesota<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#in-class-work"><i class="fa fa-check"></i><b>4.2</b> In-Class work<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#show-a-map-outline-of-iowa-and-illinois-similar-to-minnesota-map-upstream"><i class="fa fa-check"></i><b>4.3</b> 1) Show a map outline of Iowa and Illinois (similar to Minnesota map upstream)<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#subset-lagos-data-to-these-sites-how-many-sites-are-in-illinois-and-iowa-combined-how-does-this-compare-to-minnesota"><i class="fa fa-check"></i><b>4.4</b> 2) Subset LAGOS data to these sites, how many sites are in Illinois and Iowa combined? How does this compare to Minnesota?<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#what-is-the-distribution-of-lake-size-in-iowa-vs.-minnesota"><i class="fa fa-check"></i><b>4.5</b> 3) What is the distribution of lake size in Iowa vs. Minnesota?<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#make-an-interactive-plot-of-lakes-in-iowa-and-illinois-and-color-them-by-lake-area-in-hectares"><i class="fa fa-check"></i><b>4.6</b> 4) Make an interactive plot of lakes in Iowa and Illinois and color them by lake area in hectares<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="lagos-spatial-analysis.html"><a href="lagos-spatial-analysis.html#what-other-data-sources-might-we-use-to-understand-how-reservoirs-and-natural-lakes-vary-in-size-in-these-three-states"><i class="fa fa-check"></i><b>4.7</b> 5) What other data sources might we use to understand how reservoirs and natural lakes vary in size in these three states?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html"><i class="fa fa-check"></i><b>5</b> Lake Water Quality Analysis<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#loading-in-data-1"><i class="fa fa-check"></i><b>5.1</b> Loading in data<span></span></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#first-download-and-then-specifically-grab-the-locus-or-site-lat-longs-1"><i class="fa fa-check"></i><b>5.1.1</b> First download and then specifically grab the locus (or site lat longs)<span></span></a></li>
<li class="chapter" data-level="5.1.2" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#subset-columns-nutr-to-only-keep-key-info-that-we-want"><i class="fa fa-check"></i><b>5.1.2</b> Subset columns nutr to only keep key info that we want<span></span></a></li>
<li class="chapter" data-level="5.1.3" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#keep-sites-with-at-least-200-observations"><i class="fa fa-check"></i><b>5.1.3</b> Keep sites with at least 200 observations<span></span></a></li>
<li class="chapter" data-level="5.1.4" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#join-water-quality-data-to-spatial-data"><i class="fa fa-check"></i><b>5.1.4</b> Join water quality data to spatial data<span></span></a></li>
<li class="chapter" data-level="5.1.5" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#mean-chl_a-map"><i class="fa fa-check"></i><b>5.1.5</b> Mean Chl_a map<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#class-work"><i class="fa fa-check"></i><b>5.2</b> Class work<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#what-is-the-correlation-between-secchi-disk-depth-and-chlorophyll-a-for-sites-with-at-least-200-observations"><i class="fa fa-check"></i><b>5.3</b> 1) What is the correlation between Secchi Disk Depth and Chlorophyll a for sites with at least 200 observations?<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#why-might-this-be-the-case"><i class="fa fa-check"></i><b>5.4</b> Why might this be the case?<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#what-states-have-the-most-data"><i class="fa fa-check"></i><b>5.5</b> 2) What states have the most data?<span></span></a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#a-first-you-will-need-to-make-a-lagos-spatial-dataset-that-has-the-total-number-of-counts-per-site."><i class="fa fa-check"></i><b>5.5.1</b> 2a) First you will need to make a lagos spatial dataset that has the total number of counts per site.<span></span></a></li>
<li class="chapter" data-level="5.5.2" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#b-second-you-will-need-to-join-this-point-dataset-to-the-us_boundaries"><i class="fa fa-check"></i><b>5.5.2</b> 2b) Second, you will need to join this point dataset to the us_boundaries<span></span></a></li>
<li class="chapter" data-level="5.5.3" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#c-then-you-will-want-to-group-by-state-and-sum-all-the-observations-in-that"><i class="fa fa-check"></i><b>5.5.3</b> 2c) Then you will want to group by state and sum all the observations in that<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="lake-water-quality-analysis.html"><a href="lake-water-quality-analysis.html#is-there-a-spatial-pattern-in-secchi-disk-depth-for-lakes-with-at-least-200"><i class="fa fa-check"></i><b>5.6</b> 3) Is there a spatial pattern in Secchi disk depth for lakes with at least 200<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html"><i class="fa fa-check"></i><b>6</b> Weather and Corn Yield Regressions<span></span></a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#load-the-prism-daily-maximum-temperatures"><i class="fa fa-check"></i><b>6.0.1</b> Load the PRISM daily maximum temperatures<span></span></a></li>
<li class="chapter" data-level="6.1" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#temperature-trends"><i class="fa fa-check"></i><b>6.1</b> Temperature trends<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#summer-temperature-trends-winneshiek-county"><i class="fa fa-check"></i><b>6.1.1</b> Summer temperature trends: Winneshiek County<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#winter-temperatures---winneshiek-county"><i class="fa fa-check"></i><b>6.1.2</b> Winter Temperatures - Winneshiek County<span></span></a></li>
<li class="chapter" data-level="6.1.3" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#multiple-regression-quadratic-time-trend"><i class="fa fa-check"></i><b>6.1.3</b> Multiple regression – Quadratic time trend<span></span></a></li>
<li class="chapter" data-level="6.1.4" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#download-nass-corn-yield-data"><i class="fa fa-check"></i><b>6.1.4</b> Download NASS corn yield data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#assignment-2"><i class="fa fa-check"></i><b>6.2</b> Assignment<span></span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#question-1a-extract-winneshiek-county-corn-yields-fit-a-linear-time-trend-make-a-plot.-is-there-a-significant-time-trend"><i class="fa fa-check"></i><b>6.2.1</b> Question 1a: Extract Winneshiek County corn yields, fit a linear time trend, make a plot. Is there a significant time trend?<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#question-1b-fit-a-quadratic-time-trend-i.e.-year-year2-and-make-a-plot.-is-there-evidence-for-slowing-yield-growth"><i class="fa fa-check"></i><b>6.2.2</b> Question 1b: Fit a quadratic time trend (i.e., year + year^2) and make a plot. Is there evidence for slowing yield growth?<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#question-2-time-series-lets-analyze-the-relationship-between-temperature-and-yields-for-the-winneshiek-county-time-series.-use-data-on-yield-and-summer-avg-tmax.-is-adding-year-or-tmax2-to-your-model-helpful-make-a-plot-and-interpret-the-results."><i class="fa fa-check"></i><b>6.2.3</b> Question 2 – Time Series: Let’s analyze the relationship between temperature and yields for the Winneshiek County time series. Use data on yield and summer avg Tmax. Is adding year or Tmax^2 to your model helpful? Make a plot and interpret the results.<span></span></a></li>
<li class="chapter" data-level="6.2.4" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#question-3-cross-section-analyze-the-relationship-between-temperature-and-yield-across-all-counties-in-2018.-is-there-a-relationship-interpret-the-results."><i class="fa fa-check"></i><b>6.2.4</b> Question 3 – Cross-Section: Analyze the relationship between temperature and yield across all counties in 2018. Is there a relationship? Interpret the results.<span></span></a></li>
<li class="chapter" data-level="6.2.5" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#question-4-panel-one-way-to-leverage-multiple-time-series-is-to-group-all-data-into-what-is-called-a-panel-regression.-convert-the-county-id-code-countyfp-or-county_ansi-into-factor-using-as.factor-then-include-this-variable-in-a-regression-using-all-counties-yield-and-summer-temperature-data.-how-does-the-significance-of-your-temperature-coefficients-tmax-tmax2-change-make-a-plot-comparing-actual-and-fitted-yields-and-interpret-the-results-of-your-model."><i class="fa fa-check"></i><b>6.2.5</b> Question 4 – Panel: One way to leverage multiple time series is to group all data into what is called a “panel” regression. Convert the county ID code (“countyfp” or “county_ansi”) into factor using as.factor, then include this variable in a regression using all counties’ yield and summer temperature data. How does the significance of your temperature coefficients (Tmax, Tmax^2) change? Make a plot comparing actual and fitted yields and interpret the results of your model.<span></span></a></li>
<li class="chapter" data-level="6.2.6" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#question-5-soybeans-download-nass-data-on-soybean-yields-and-explore-either-a-time-series-relationship-for-a-given-county-the-cross-sectional-relationship-for-a-given-year-or-a-panel-across-all-counties-and-years."><i class="fa fa-check"></i><b>6.2.6</b> Question 5 – Soybeans: Download NASS data on soybean yields and explore either a time series relationship for a given county, the cross-sectional relationship for a given year, or a panel across all counties and years.<span></span></a></li>
<li class="chapter" data-level="6.2.7" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#bonus-find-a-package-to-make-a-county-map-of-iowa-displaying-some-sort-of-information-about-yields-or-weather.-interpret-your-map."><i class="fa fa-check"></i><b>6.2.7</b> Bonus: Find a package to make a county map of Iowa displaying some sort of information about yields or weather. Interpret your map.<span></span></a></li>
<li class="chapter" data-level="6.2.8" data-path="weather-and-corn-yield-regressions.html"><a href="weather-and-corn-yield-regressions.html#bonus-2-challenge-question---map-trends-in-corn-yields-by-county-across-iowa.-interpret-your-map."><i class="fa fa-check"></i><b>6.2.8</b> Bonus #2: Challenge question - map trends in corn yields by county across Iowa. Interpret your map.<span></span></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ESS 580A7 Introduction to Environmental Data Science Project Compilation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="weather-and-corn-yield-regressions" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Weather and Corn Yield Regressions<a href="weather-and-corn-yield-regressions.html#weather-and-corn-yield-regressions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="load-the-prism-daily-maximum-temperatures" class="section level3 hasAnchor" number="6.0.1">
<h3><span class="header-section-number">6.0.1</span> Load the PRISM daily maximum temperatures<a href="weather-and-corn-yield-regressions.html#load-the-prism-daily-maximum-temperatures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="weather-and-corn-yield-regressions.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># daily max temperature</span></span>
<span id="cb59-2"><a href="weather-and-corn-yield-regressions.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dimensions: counties x days x years</span></span>
<span id="cb59-3"><a href="weather-and-corn-yield-regressions.html#cb59-3" aria-hidden="true" tabindex="-1"></a>prism <span class="ot">&lt;-</span> <span class="fu">readMat</span>(<span class="st">&quot;05-data/prismiowa.mat&quot;</span>)</span>
<span id="cb59-4"><a href="weather-and-corn-yield-regressions.html#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="weather-and-corn-yield-regressions.html#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co"># look at county #1</span></span>
<span id="cb59-6"><a href="weather-and-corn-yield-regressions.html#cb59-6" aria-hidden="true" tabindex="-1"></a>t_1981_c1 <span class="ot">&lt;-</span> prism<span class="sc">$</span>tmaxdaily.iowa[<span class="dv">1</span>,,<span class="dv">1</span>]</span>
<span id="cb59-7"><a href="weather-and-corn-yield-regressions.html#cb59-7" aria-hidden="true" tabindex="-1"></a>t_1981_c1[<span class="dv">366</span>]</span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="weather-and-corn-yield-regressions.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">366</span>, t_1981_c1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="580A7-Bookdown_files/figure-html/tmax%20data-1.png" width="672" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="weather-and-corn-yield-regressions.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb62-2"><a href="weather-and-corn-yield-regressions.html#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">366</span>, <span class="at">y =</span> t_1981_c1)) <span class="sc">+</span></span>
<span id="cb62-3"><a href="weather-and-corn-yield-regressions.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb62-4"><a href="weather-and-corn-yield-regressions.html#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;day of year&quot;</span>) <span class="sc">+</span></span>
<span id="cb62-5"><a href="weather-and-corn-yield-regressions.html#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;daily maximum temperature (°C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="weather-and-corn-yield-regressions.html#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Daily Maximum Temperature, Iowa County #1&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 1 row(s) containing missing values (geom_path).</code></pre>
<p><img src="580A7-Bookdown_files/figure-html/tmax%20data-2.png" width="672" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="weather-and-corn-yield-regressions.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assign dimension names to tmax matrix</span></span>
<span id="cb64-2"><a href="weather-and-corn-yield-regressions.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(prism<span class="sc">$</span>tmaxdaily.iowa) <span class="ot">&lt;-</span> <span class="fu">list</span>(prism<span class="sc">$</span>COUNTYFP, <span class="dv">1</span><span class="sc">:</span><span class="dv">366</span>, prism<span class="sc">$</span>years)</span>
<span id="cb64-3"><a href="weather-and-corn-yield-regressions.html#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="weather-and-corn-yield-regressions.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># converted 3d matrix into a data frame</span></span>
<span id="cb64-5"><a href="weather-and-corn-yield-regressions.html#cb64-5" aria-hidden="true" tabindex="-1"></a>tmaxdf <span class="ot">&lt;-</span> <span class="fu">as.data.frame.table</span>(prism<span class="sc">$</span>tmaxdaily.iowa)</span>
<span id="cb64-6"><a href="weather-and-corn-yield-regressions.html#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="weather-and-corn-yield-regressions.html#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># relabel the columns</span></span>
<span id="cb64-8"><a href="weather-and-corn-yield-regressions.html#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tmaxdf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;countyfp&quot;</span>,<span class="st">&quot;doy&quot;</span>,<span class="st">&quot;year&quot;</span>,<span class="st">&quot;tmax&quot;</span>)</span>
<span id="cb64-9"><a href="weather-and-corn-yield-regressions.html#cb64-9" aria-hidden="true" tabindex="-1"></a>tmaxdf <span class="ot">&lt;-</span> <span class="fu">tibble</span>(tmaxdf)</span></code></pre></div>
</div>
<div id="temperature-trends" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Temperature trends<a href="weather-and-corn-yield-regressions.html#temperature-trends" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="summer-temperature-trends-winneshiek-county" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Summer temperature trends: Winneshiek County<a href="weather-and-corn-yield-regressions.html#summer-temperature-trends-winneshiek-county" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="weather-and-corn-yield-regressions.html#cb65-1" aria-hidden="true" tabindex="-1"></a>tmaxdf<span class="sc">$</span>doy <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tmaxdf<span class="sc">$</span>doy)</span>
<span id="cb65-2"><a href="weather-and-corn-yield-regressions.html#cb65-2" aria-hidden="true" tabindex="-1"></a>tmaxdf<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(tmaxdf<span class="sc">$</span>year))</span>
<span id="cb65-3"><a href="weather-and-corn-yield-regressions.html#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="weather-and-corn-yield-regressions.html#cb65-4" aria-hidden="true" tabindex="-1"></a>winnesummer <span class="ot">&lt;-</span> tmaxdf <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="weather-and-corn-yield-regressions.html#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(countyfp<span class="sc">==</span><span class="dv">191</span> <span class="sc">&amp;</span> doy <span class="sc">&gt;=</span> <span class="dv">152</span> <span class="sc">&amp;</span> doy <span class="sc">&lt;=</span> <span class="dv">243</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-6"><a href="weather-and-corn-yield-regressions.html#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="weather-and-corn-yield-regressions.html#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meantmax =</span> <span class="fu">mean</span>(tmax))</span>
<span id="cb65-8"><a href="weather-and-corn-yield-regressions.html#cb65-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-9"><a href="weather-and-corn-yield-regressions.html#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(winnesummer, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> meantmax)) <span class="sc">+</span></span>
<span id="cb65-10"><a href="weather-and-corn-yield-regressions.html#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb65-11"><a href="weather-and-corn-yield-regressions.html#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb65-12"><a href="weather-and-corn-yield-regressions.html#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Tmax (°C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb65-13"><a href="weather-and-corn-yield-regressions.html#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="580A7-Bookdown_files/figure-html/temp%20trends-1.png" width="672" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="weather-and-corn-yield-regressions.html#cb67-1" aria-hidden="true" tabindex="-1"></a>lm_summertmax <span class="ot">&lt;-</span> <span class="fu">lm</span>(meantmax <span class="sc">~</span> year, winnesummer)</span>
<span id="cb67-2"><a href="weather-and-corn-yield-regressions.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_summertmax)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = meantmax ~ year, data = winnesummer)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.5189 -0.7867 -0.0341  0.6859  3.7415 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) 41.57670   36.44848   1.141    0.262
## year        -0.00747    0.01823  -0.410    0.684
## 
## Residual standard error: 1.232 on 36 degrees of freedom
## Multiple R-squared:  0.004644,   Adjusted R-squared:  -0.02301 
## F-statistic: 0.168 on 1 and 36 DF,  p-value: 0.6844</code></pre>
</div>
<div id="winter-temperatures---winneshiek-county" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Winter Temperatures - Winneshiek County<a href="weather-and-corn-yield-regressions.html#winter-temperatures---winneshiek-county" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="weather-and-corn-yield-regressions.html#cb69-1" aria-hidden="true" tabindex="-1"></a>winnewinter <span class="ot">&lt;-</span> tmaxdf <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="weather-and-corn-yield-regressions.html#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(countyfp<span class="sc">==</span><span class="dv">191</span> <span class="sc">&amp;</span> (doy <span class="sc">&lt;=</span> <span class="dv">59</span> <span class="sc">|</span> doy <span class="sc">&gt;=</span> <span class="dv">335</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tmax)) <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="weather-and-corn-yield-regressions.html#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="weather-and-corn-yield-regressions.html#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meantmax =</span> <span class="fu">mean</span>(tmax))</span>
<span id="cb69-5"><a href="weather-and-corn-yield-regressions.html#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="weather-and-corn-yield-regressions.html#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(winnewinter, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> meantmax)) <span class="sc">+</span></span>
<span id="cb69-7"><a href="weather-and-corn-yield-regressions.html#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb69-8"><a href="weather-and-corn-yield-regressions.html#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb69-9"><a href="weather-and-corn-yield-regressions.html#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Tmax (°C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb69-10"><a href="weather-and-corn-yield-regressions.html#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code></pre></div>
<p><img src="580A7-Bookdown_files/figure-html/winter%20temps-1.png" width="672" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="weather-and-corn-yield-regressions.html#cb70-1" aria-hidden="true" tabindex="-1"></a>lm_wintertmax <span class="ot">&lt;-</span> <span class="fu">lm</span>(meantmax <span class="sc">~</span> year, winnewinter)</span>
<span id="cb70-2"><a href="weather-and-corn-yield-regressions.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_wintertmax)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = meantmax ~ year, data = winnewinter)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.5978 -1.4917 -0.3053  1.3778  4.5709 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -29.87825   60.48100  -0.494    0.624
## year          0.01368    0.03025   0.452    0.654
## 
## Residual standard error: 2.045 on 36 degrees of freedom
## Multiple R-squared:  0.005652,   Adjusted R-squared:  -0.02197 
## F-statistic: 0.2046 on 1 and 36 DF,  p-value: 0.6537</code></pre>
</div>
<div id="multiple-regression-quadratic-time-trend" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Multiple regression – Quadratic time trend<a href="weather-and-corn-yield-regressions.html#multiple-regression-quadratic-time-trend" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="weather-and-corn-yield-regressions.html#cb72-1" aria-hidden="true" tabindex="-1"></a>winnewinter<span class="sc">$</span>yearsq <span class="ot">&lt;-</span> winnewinter<span class="sc">$</span>year<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb72-2"><a href="weather-and-corn-yield-regressions.html#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="weather-and-corn-yield-regressions.html#cb72-3" aria-hidden="true" tabindex="-1"></a>lm_wintertmaxquad <span class="ot">&lt;-</span> <span class="fu">lm</span>(meantmax <span class="sc">~</span> year <span class="sc">+</span> yearsq, winnewinter)</span>
<span id="cb72-4"><a href="weather-and-corn-yield-regressions.html#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_wintertmaxquad)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = meantmax ~ year + yearsq, data = winnewinter)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.3539 -1.2985 -0.2813  1.4055  4.2620 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -1.086e+04  1.238e+04  -0.877    0.386
## year         1.085e+01  1.239e+01   0.876    0.387
## yearsq      -2.710e-03  3.097e-03  -0.875    0.388
## 
## Residual standard error: 2.051 on 35 degrees of freedom
## Multiple R-squared:  0.02694,    Adjusted R-squared:  -0.02867 
## F-statistic: 0.4845 on 2 and 35 DF,  p-value: 0.6201</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="weather-and-corn-yield-regressions.html#cb74-1" aria-hidden="true" tabindex="-1"></a>winnewinter<span class="sc">$</span>fitted <span class="ot">&lt;-</span> lm_wintertmaxquad<span class="sc">$</span>fitted.values</span>
<span id="cb74-2"><a href="weather-and-corn-yield-regressions.html#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="weather-and-corn-yield-regressions.html#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(winnewinter) <span class="sc">+</span></span>
<span id="cb74-4"><a href="weather-and-corn-yield-regressions.html#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> meantmax)) <span class="sc">+</span></span>
<span id="cb74-5"><a href="weather-and-corn-yield-regressions.html#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> fitted)) <span class="sc">+</span></span>
<span id="cb74-6"><a href="weather-and-corn-yield-regressions.html#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb74-7"><a href="weather-and-corn-yield-regressions.html#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;tmax&quot;</span>)</span></code></pre></div>
<p><img src="580A7-Bookdown_files/figure-html/quadratic%20temp%20trend-1.png" width="672" /></p>
</div>
<div id="download-nass-corn-yield-data" class="section level3 hasAnchor" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> Download NASS corn yield data<a href="weather-and-corn-yield-regressions.html#download-nass-corn-yield-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="weather-and-corn-yield-regressions.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set our API key with NASS from source api file</span></span>
<span id="cb75-2"><a href="weather-and-corn-yield-regressions.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;C:/Users/devin/Desktop/CSU/S22/ESS 580A7/Bookdown/api-key.R&quot;</span>)</span>
<span id="cb75-3"><a href="weather-and-corn-yield-regressions.html#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nassqs_auth</span>(<span class="at">key =</span> nass_api_key)</span>
<span id="cb75-4"><a href="weather-and-corn-yield-regressions.html#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="weather-and-corn-yield-regressions.html#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters to query on </span></span>
<span id="cb75-6"><a href="weather-and-corn-yield-regressions.html#cb75-6" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">commodity_desc =</span> <span class="st">&quot;CORN&quot;</span>, <span class="at">util_practice_desc =</span> <span class="st">&quot;GRAIN&quot;</span>, <span class="at">prodn_practice_desc =</span> <span class="st">&quot;ALL PRODUCTION PRACTICES&quot;</span>, <span class="at">year__GE =</span> <span class="dv">1981</span>, <span class="at">state_alpha =</span> <span class="st">&quot;IA&quot;</span>)</span>
<span id="cb75-7"><a href="weather-and-corn-yield-regressions.html#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="weather-and-corn-yield-regressions.html#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb75-9"><a href="weather-and-corn-yield-regressions.html#cb75-9" aria-hidden="true" tabindex="-1"></a>cornyieldsall <span class="ot">&lt;-</span> <span class="fu">nassqs_yields</span>(params)</span></code></pre></div>
<pre><code>## 
  |                                                                                                          
  |                                                                                                    |   0%
  |                                                                                                          
  |=                                                                                                   |   1%
  |                                                                                                          
  |==                                                                                                  |   2%
  |                                                                                                          
  |===                                                                                                 |   3%
  |                                                                                                          
  |====                                                                                                |   4%
  |                                                                                                          
  |=====                                                                                               |   5%
  |                                                                                                          
  |======                                                                                              |   6%
  |                                                                                                          
  |=======                                                                                             |   7%
  |                                                                                                          
  |========                                                                                            |   8%
  |                                                                                                          
  |=========                                                                                           |   9%
  |                                                                                                          
  |==========                                                                                          |  10%
  |                                                                                                          
  |===========                                                                                         |  11%
  |                                                                                                          
  |============                                                                                        |  12%
  |                                                                                                          
  |=============                                                                                       |  13%
  |                                                                                                          
  |==============                                                                                      |  14%
  |                                                                                                          
  |===============                                                                                     |  15%
  |                                                                                                          
  |================                                                                                    |  16%
  |                                                                                                          
  |=================                                                                                   |  17%
  |                                                                                                          
  |==================                                                                                  |  18%
  |                                                                                                          
  |===================                                                                                 |  19%
  |                                                                                                          
  |====================                                                                                |  20%
  |                                                                                                          
  |=====================                                                                               |  21%
  |                                                                                                          
  |======================                                                                              |  22%
  |                                                                                                          
  |=======================                                                                             |  23%
  |                                                                                                          
  |========================                                                                            |  24%
  |                                                                                                          
  |=========================                                                                           |  25%
  |                                                                                                          
  |==========================                                                                          |  26%
  |                                                                                                          
  |===========================                                                                         |  27%
  |                                                                                                          
  |============================                                                                        |  28%
  |                                                                                                          
  |=============================                                                                       |  29%
  |                                                                                                          
  |==============================                                                                      |  30%
  |                                                                                                          
  |===============================                                                                     |  31%
  |                                                                                                          
  |================================                                                                    |  32%
  |                                                                                                          
  |=================================                                                                   |  33%
  |                                                                                                          
  |==================================                                                                  |  34%
  |                                                                                                          
  |===================================                                                                 |  35%
  |                                                                                                          
  |====================================                                                                |  36%
  |                                                                                                          
  |=====================================                                                               |  37%
  |                                                                                                          
  |======================================                                                              |  38%
  |                                                                                                          
  |=======================================                                                             |  39%
  |                                                                                                          
  |========================================                                                            |  40%
  |                                                                                                          
  |=========================================                                                           |  41%
  |                                                                                                          
  |==========================================                                                          |  42%
  |                                                                                                          
  |===========================================                                                         |  43%
  |                                                                                                          
  |============================================                                                        |  44%
  |                                                                                                          
  |=============================================                                                       |  45%
  |                                                                                                          
  |==============================================                                                      |  46%
  |                                                                                                          
  |===============================================                                                     |  47%
  |                                                                                                          
  |================================================                                                    |  48%
  |                                                                                                          
  |=================================================                                                   |  49%
  |                                                                                                          
  |==================================================                                                  |  50%
  |                                                                                                          
  |===================================================                                                 |  51%
  |                                                                                                          
  |====================================================                                                |  52%
  |                                                                                                          
  |=====================================================                                               |  53%
  |                                                                                                          
  |======================================================                                              |  54%
  |                                                                                                          
  |=======================================================                                             |  55%
  |                                                                                                          
  |========================================================                                            |  56%
  |                                                                                                          
  |=========================================================                                           |  57%
  |                                                                                                          
  |==========================================================                                          |  58%
  |                                                                                                          
  |===========================================================                                         |  59%
  |                                                                                                          
  |============================================================                                        |  60%
  |                                                                                                          
  |=============================================================                                       |  61%
  |                                                                                                          
  |==============================================================                                      |  62%
  |                                                                                                          
  |===============================================================                                     |  63%
  |                                                                                                          
  |================================================================                                    |  64%
  |                                                                                                          
  |=================================================================                                   |  65%
  |                                                                                                          
  |==================================================================                                  |  66%
  |                                                                                                          
  |===================================================================                                 |  67%
  |                                                                                                          
  |====================================================================                                |  68%
  |                                                                                                          
  |=====================================================================                               |  69%
  |                                                                                                          
  |======================================================================                              |  70%
  |                                                                                                          
  |=======================================================================                             |  71%
  |                                                                                                          
  |========================================================================                            |  72%
  |                                                                                                          
  |=========================================================================                           |  73%
  |                                                                                                          
  |==========================================================================                          |  74%
  |                                                                                                          
  |===========================================================================                         |  75%
  |                                                                                                          
  |============================================================================                        |  76%
  |                                                                                                          
  |=============================================================================                       |  77%
  |                                                                                                          
  |==============================================================================                      |  78%
  |                                                                                                          
  |===============================================================================                     |  79%
  |                                                                                                          
  |================================================================================                    |  80%
  |                                                                                                          
  |=================================================================================                   |  81%
  |                                                                                                          
  |==================================================================================                  |  82%
  |                                                                                                          
  |===================================================================================                 |  83%
  |                                                                                                          
  |====================================================================================                |  84%
  |                                                                                                          
  |=====================================================================================               |  85%
  |                                                                                                          
  |======================================================================================              |  86%
  |                                                                                                          
  |=======================================================================================             |  87%
  |                                                                                                          
  |========================================================================================            |  88%
  |                                                                                                          
  |=========================================================================================           |  89%
  |                                                                                                          
  |==========================================================================================          |  90%
  |                                                                                                          
  |===========================================================================================         |  91%
  |                                                                                                          
  |============================================================================================        |  92%
  |                                                                                                          
  |=============================================================================================       |  93%
  |                                                                                                          
  |==============================================================================================      |  94%
  |                                                                                                          
  |===============================================================================================     |  95%
  |                                                                                                          
  |================================================================================================    |  96%
  |                                                                                                          
  |=================================================================================================   |  97%
  |                                                                                                          
  |==================================================================================================  |  98%
  |                                                                                                          
  |=================================================================================================== |  99%
  |                                                                                                          
  |====================================================================================================| 100%</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="weather-and-corn-yield-regressions.html#cb77-1" aria-hidden="true" tabindex="-1"></a>cornyieldsall<span class="sc">$</span>county_ansi <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(cornyieldsall<span class="sc">$</span>county_ansi)</span>
<span id="cb77-2"><a href="weather-and-corn-yield-regressions.html#cb77-2" aria-hidden="true" tabindex="-1"></a>cornyieldsall<span class="sc">$</span>yield <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(cornyieldsall<span class="sc">$</span>Value)</span>
<span id="cb77-3"><a href="weather-and-corn-yield-regressions.html#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="weather-and-corn-yield-regressions.html#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># clean and filter this dataset</span></span>
<span id="cb77-5"><a href="weather-and-corn-yield-regressions.html#cb77-5" aria-hidden="true" tabindex="-1"></a>cornyields <span class="ot">&lt;-</span> <span class="fu">select</span>(cornyieldsall, county_ansi, county_name, yield, year) <span class="sc">%&gt;%</span></span>
<span id="cb77-6"><a href="weather-and-corn-yield-regressions.html#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(county_ansi) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(yield))</span>
<span id="cb77-7"><a href="weather-and-corn-yield-regressions.html#cb77-7" aria-hidden="true" tabindex="-1"></a>cornyields <span class="ot">&lt;-</span> <span class="fu">tibble</span>(cornyields)</span></code></pre></div>
</div>
</div>
<div id="assignment-2" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Assignment<a href="weather-and-corn-yield-regressions.html#assignment-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="question-1a-extract-winneshiek-county-corn-yields-fit-a-linear-time-trend-make-a-plot.-is-there-a-significant-time-trend" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Question 1a: Extract Winneshiek County corn yields, fit a linear time trend, make a plot. Is there a significant time trend?<a href="weather-and-corn-yield-regressions.html#question-1a-extract-winneshiek-county-corn-yields-fit-a-linear-time-trend-make-a-plot.-is-there-a-significant-time-trend" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="weather-and-corn-yield-regressions.html#cb78-1" aria-hidden="true" tabindex="-1"></a>winne_yield <span class="ot">&lt;-</span> cornyields <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="weather-and-corn-yield-regressions.html#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(county_ansi <span class="sc">==</span> <span class="dv">191</span>)</span>
<span id="cb78-3"><a href="weather-and-corn-yield-regressions.html#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="weather-and-corn-yield-regressions.html#cb78-4" aria-hidden="true" tabindex="-1"></a>winne_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> year, winne_yield)</span>
<span id="cb78-5"><a href="weather-and-corn-yield-regressions.html#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(winne_lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ year, data = winne_yield)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -51.163  -1.841   2.363   9.437  24.376 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -4763.290    448.286  -10.63 4.46e-13 ***
## year            2.457      0.224   10.96 1.77e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 16.97 on 39 degrees of freedom
## Multiple R-squared:  0.7551, Adjusted R-squared:  0.7488 
## F-statistic: 120.2 on 1 and 39 DF,  p-value: 1.767e-13</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="weather-and-corn-yield-regressions.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(winne_yield, <span class="fu">aes</span>(year, yield)) <span class="sc">+</span> </span>
<span id="cb80-2"><a href="weather-and-corn-yield-regressions.html#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;darkgoldenrod1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb80-3"><a href="weather-and-corn-yield-regressions.html#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">color =</span> <span class="st">&quot;green4&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-4"><a href="weather-and-corn-yield-regressions.html#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Average Annual Corn Yield in Winneshank, Iowa [Linear Fit]&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Yield&quot;</span>)</span></code></pre></div>
<p><img src="580A7-Bookdown_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
<div id="question-1b-fit-a-quadratic-time-trend-i.e.-year-year2-and-make-a-plot.-is-there-evidence-for-slowing-yield-growth" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Question 1b: Fit a quadratic time trend (i.e., year + year^2) and make a plot. Is there evidence for slowing yield growth?<a href="weather-and-corn-yield-regressions.html#question-1b-fit-a-quadratic-time-trend-i.e.-year-year2-and-make-a-plot.-is-there-evidence-for-slowing-yield-growth" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="weather-and-corn-yield-regressions.html#cb81-1" aria-hidden="true" tabindex="-1"></a>winne_yield<span class="sc">$</span>yearsq <span class="ot">&lt;-</span> winne_yield<span class="sc">$</span>year<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb81-2"><a href="weather-and-corn-yield-regressions.html#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="weather-and-corn-yield-regressions.html#cb81-3" aria-hidden="true" tabindex="-1"></a>winne_quad <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> year <span class="sc">+</span> yearsq, winne_yield)</span>
<span id="cb81-4"><a href="weather-and-corn-yield-regressions.html#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(winne_quad)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ year + yearsq, data = winne_yield)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -51.384  -3.115   1.388   9.743  25.324 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  2.583e+04  8.580e+04   0.301    0.765
## year        -2.812e+01  8.576e+01  -0.328    0.745
## yearsq       7.641e-03  2.143e-02   0.357    0.723
## 
## Residual standard error: 17.17 on 38 degrees of freedom
## Multiple R-squared:  0.7559, Adjusted R-squared:  0.7431 
## F-statistic: 58.84 on 2 and 38 DF,  p-value: 2.311e-12</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="weather-and-corn-yield-regressions.html#cb83-1" aria-hidden="true" tabindex="-1"></a>winne_yield<span class="sc">$</span>quadraticfit <span class="ot">&lt;-</span> winne_quad<span class="sc">$</span>fitted.values</span>
<span id="cb83-2"><a href="weather-and-corn-yield-regressions.html#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="weather-and-corn-yield-regressions.html#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="weather-and-corn-yield-regressions.html#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(winne_yield, <span class="fu">aes</span>(year, yield)) <span class="sc">+</span> </span>
<span id="cb83-5"><a href="weather-and-corn-yield-regressions.html#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;darkgoldenrod1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb83-6"><a href="weather-and-corn-yield-regressions.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(year, quadraticfit), <span class="at">color =</span> <span class="st">&quot;green4&quot;</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb83-7"><a href="weather-and-corn-yield-regressions.html#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Average Annual Corn Yield in Winneshank, Iowa [Quadratic Fit]&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Yield&quot;</span>)</span></code></pre></div>
<p><img src="580A7-Bookdown_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="question-2-time-series-lets-analyze-the-relationship-between-temperature-and-yields-for-the-winneshiek-county-time-series.-use-data-on-yield-and-summer-avg-tmax.-is-adding-year-or-tmax2-to-your-model-helpful-make-a-plot-and-interpret-the-results." class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Question 2 – Time Series: Let’s analyze the relationship between temperature and yields for the Winneshiek County time series. Use data on yield and summer avg Tmax. Is adding year or Tmax^2 to your model helpful? Make a plot and interpret the results.<a href="weather-and-corn-yield-regressions.html#question-2-time-series-lets-analyze-the-relationship-between-temperature-and-yields-for-the-winneshiek-county-time-series.-use-data-on-yield-and-summer-avg-tmax.-is-adding-year-or-tmax2-to-your-model-helpful-make-a-plot-and-interpret-the-results." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="weather-and-corn-yield-regressions.html#cb84-1" aria-hidden="true" tabindex="-1"></a>winne_yield_temp <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(winne_yield, winnesummer, <span class="at">by =</span> <span class="st">&quot;year&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="weather-and-corn-yield-regressions.html#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>quadraticfit)</span>
<span id="cb84-3"><a href="weather-and-corn-yield-regressions.html#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="weather-and-corn-yield-regressions.html#cb84-4" aria-hidden="true" tabindex="-1"></a>winne_YT_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> meantmax, winne_yield_temp)</span>
<span id="cb84-5"><a href="weather-and-corn-yield-regressions.html#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(winne_YT_lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ meantmax, data = winne_yield_temp)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -71.96 -19.85  -3.19  24.64  61.72 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  275.876    118.335   2.331   0.0255 *
## meantmax      -4.763      4.438  -1.073   0.2902  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 32.88 on 36 degrees of freedom
## Multiple R-squared:  0.03101,    Adjusted R-squared:  0.004098 
## F-statistic: 1.152 on 1 and 36 DF,  p-value: 0.2902</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="weather-and-corn-yield-regressions.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear model is less effective at showing the proper trend between yield and mean max temperature</span></span>
<span id="cb86-2"><a href="weather-and-corn-yield-regressions.html#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="weather-and-corn-yield-regressions.html#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a quadratic model for yield.</span></span>
<span id="cb86-4"><a href="weather-and-corn-yield-regressions.html#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="weather-and-corn-yield-regressions.html#cb86-5" aria-hidden="true" tabindex="-1"></a>winne_yield_temp<span class="sc">$</span>yieldsq <span class="ot">&lt;-</span> winne_yield_temp<span class="sc">$</span>yield<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb86-6"><a href="weather-and-corn-yield-regressions.html#cb86-6" aria-hidden="true" tabindex="-1"></a>winne_yield_temp<span class="sc">$</span>meantsq <span class="ot">&lt;-</span> winne_yield_temp<span class="sc">$</span>meantmax<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb86-7"><a href="weather-and-corn-yield-regressions.html#cb86-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-8"><a href="weather-and-corn-yield-regressions.html#cb86-8" aria-hidden="true" tabindex="-1"></a>winne_YT_quad <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> meantmax <span class="sc">+</span> meantsq, winne_yield_temp)</span>
<span id="cb86-9"><a href="weather-and-corn-yield-regressions.html#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(winne_YT_lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ meantmax, data = winne_yield_temp)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -71.96 -19.85  -3.19  24.64  61.72 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  275.876    118.335   2.331   0.0255 *
## meantmax      -4.763      4.438  -1.073   0.2902  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 32.88 on 36 degrees of freedom
## Multiple R-squared:  0.03101,    Adjusted R-squared:  0.004098 
## F-statistic: 1.152 on 1 and 36 DF,  p-value: 0.2902</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="weather-and-corn-yield-regressions.html#cb88-1" aria-hidden="true" tabindex="-1"></a>winne_yield_temp<span class="sc">$</span>tmaxfit <span class="ot">&lt;-</span> winne_YT_quad<span class="sc">$</span>fitted.values</span>
<span id="cb88-2"><a href="weather-and-corn-yield-regressions.html#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="weather-and-corn-yield-regressions.html#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(winne_yield_temp, <span class="fu">aes</span>(meantmax, yield)) <span class="sc">+</span> </span>
<span id="cb88-4"><a href="weather-and-corn-yield-regressions.html#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;darkgoldenrod1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb88-5"><a href="weather-and-corn-yield-regressions.html#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(meantmax, tmaxfit), <span class="at">color =</span> <span class="st">&quot;green4&quot;</span>) <span class="sc">+</span></span>
<span id="cb88-6"><a href="weather-and-corn-yield-regressions.html#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Comparison of Corn Yield to Mean Annual Max Temperature, </span><span class="sc">\n</span><span class="st">Winneshank, Iowa [Quadratic Fit]&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Mean Annual Max Temperature (C)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Yield&quot;</span>)</span></code></pre></div>
<p><img src="580A7-Bookdown_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
</div>
<div id="question-3-cross-section-analyze-the-relationship-between-temperature-and-yield-across-all-counties-in-2018.-is-there-a-relationship-interpret-the-results." class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Question 3 – Cross-Section: Analyze the relationship between temperature and yield across all counties in 2018. Is there a relationship? Interpret the results.<a href="weather-and-corn-yield-regressions.html#question-3-cross-section-analyze-the-relationship-between-temperature-and-yield-across-all-counties-in-2018.-is-there-a-relationship-interpret-the-results." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="weather-and-corn-yield-regressions.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for 2018 data, convert county to factor</span></span>
<span id="cb89-2"><a href="weather-and-corn-yield-regressions.html#cb89-2" aria-hidden="true" tabindex="-1"></a>yield_2018 <span class="ot">&lt;-</span> cornyields <span class="sc">%&gt;%</span> </span>
<span id="cb89-3"><a href="weather-and-corn-yield-regressions.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-4"><a href="weather-and-corn-yield-regressions.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">county_ansi =</span> <span class="fu">as.factor</span>(county_ansi))</span>
<span id="cb89-5"><a href="weather-and-corn-yield-regressions.html#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="weather-and-corn-yield-regressions.html#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by county, calculate mean for temp, and filter</span></span>
<span id="cb89-7"><a href="weather-and-corn-yield-regressions.html#cb89-7" aria-hidden="true" tabindex="-1"></a>temp_2018 <span class="ot">&lt;-</span> tmaxdf <span class="sc">%&gt;%</span> </span>
<span id="cb89-8"><a href="weather-and-corn-yield-regressions.html#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2018</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tmax)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-9"><a href="weather-and-corn-yield-regressions.html#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(countyfp) <span class="sc">%&gt;%</span></span>
<span id="cb89-10"><a href="weather-and-corn-yield-regressions.html#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meantmax =</span> <span class="fu">mean</span>(tmax))</span>
<span id="cb89-11"><a href="weather-and-corn-yield-regressions.html#cb89-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-12"><a href="weather-and-corn-yield-regressions.html#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert county to factor for the inner join</span></span>
<span id="cb89-13"><a href="weather-and-corn-yield-regressions.html#cb89-13" aria-hidden="true" tabindex="-1"></a>temp_2018 <span class="ot">&lt;-</span> temp_2018 <span class="sc">%&gt;%</span> </span>
<span id="cb89-14"><a href="weather-and-corn-yield-regressions.html#cb89-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">county_ansi =</span> <span class="fu">as.factor</span>(countyfp))</span>
<span id="cb89-15"><a href="weather-and-corn-yield-regressions.html#cb89-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-16"><a href="weather-and-corn-yield-regressions.html#cb89-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Join datasets, remove duplicate countyfp column</span></span>
<span id="cb89-17"><a href="weather-and-corn-yield-regressions.html#cb89-17" aria-hidden="true" tabindex="-1"></a>YT_2018 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(yield_2018, temp_2018, <span class="at">by =</span> <span class="st">&quot;county_ansi&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-18"><a href="weather-and-corn-yield-regressions.html#cb89-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>countyfp)</span>
<span id="cb89-19"><a href="weather-and-corn-yield-regressions.html#cb89-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-20"><a href="weather-and-corn-yield-regressions.html#cb89-20" aria-hidden="true" tabindex="-1"></a>YT_2018<span class="sc">$</span>meantsq <span class="ot">&lt;-</span> YT_2018<span class="sc">$</span>meantmax<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb89-21"><a href="weather-and-corn-yield-regressions.html#cb89-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-22"><a href="weather-and-corn-yield-regressions.html#cb89-22" aria-hidden="true" tabindex="-1"></a>YT_quad <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> meantmax <span class="sc">+</span> meantsq, YT_2018)</span>
<span id="cb89-23"><a href="weather-and-corn-yield-regressions.html#cb89-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(YT_2018)</span></code></pre></div>
<pre><code>##   county_ansi county_name            yield            year         meantmax        meantsq     
##  1      : 1   Length:93          Min.   :149.5   Min.   :2018   Min.   :11.41   Min.   :130.3  
##  3      : 1   Class :character   1st Qu.:180.2   1st Qu.:2018   1st Qu.:12.88   1st Qu.:165.8  
##  5      : 1   Mode  :character   Median :193.3   Median :2018   Median :13.87   Median :192.3  
##  9      : 1                      Mean   :193.3   Mean   :2018   Mean   :13.90   Mean   :194.9  
##  11     : 1                      3rd Qu.:211.3   3rd Qu.:2018   3rd Qu.:15.06   3rd Qu.:226.9  
##  13     : 1                      Max.   :226.0   Max.   :2018   Max.   :16.25   Max.   :264.1  
##  (Other):87</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="weather-and-corn-yield-regressions.html#cb91-1" aria-hidden="true" tabindex="-1"></a>YT_2018<span class="sc">$</span>tmaxfit <span class="ot">&lt;-</span> YT_quad<span class="sc">$</span>fitted.values</span>
<span id="cb91-2"><a href="weather-and-corn-yield-regressions.html#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="weather-and-corn-yield-regressions.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(YT_2018, <span class="fu">aes</span>(meantmax, yield)) <span class="sc">+</span> </span>
<span id="cb91-4"><a href="weather-and-corn-yield-regressions.html#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;darkgoldenrod1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb91-5"><a href="weather-and-corn-yield-regressions.html#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(meantmax, tmaxfit), <span class="at">color =</span> <span class="st">&quot;green4&quot;</span>) <span class="sc">+</span></span>
<span id="cb91-6"><a href="weather-and-corn-yield-regressions.html#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Comparison of Corn Yield to Mean Annual Max Temperature, </span><span class="sc">\n</span><span class="st">All Iowa Counties [Quadratic Fit]&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Mean Annual Max Temperature (C)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Yield&quot;</span>)</span></code></pre></div>
<p><img src="580A7-Bookdown_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>From our plot, we can see that average temperatures (~13.75C) produce the highest yield across all counties in Iowa. As average max temperatures reach extremes, yields are reduced.</p>
</div>
<div id="question-4-panel-one-way-to-leverage-multiple-time-series-is-to-group-all-data-into-what-is-called-a-panel-regression.-convert-the-county-id-code-countyfp-or-county_ansi-into-factor-using-as.factor-then-include-this-variable-in-a-regression-using-all-counties-yield-and-summer-temperature-data.-how-does-the-significance-of-your-temperature-coefficients-tmax-tmax2-change-make-a-plot-comparing-actual-and-fitted-yields-and-interpret-the-results-of-your-model." class="section level3 hasAnchor" number="6.2.5">
<h3><span class="header-section-number">6.2.5</span> Question 4 – Panel: One way to leverage multiple time series is to group all data into what is called a “panel” regression. Convert the county ID code (“countyfp” or “county_ansi”) into factor using as.factor, then include this variable in a regression using all counties’ yield and summer temperature data. How does the significance of your temperature coefficients (Tmax, Tmax^2) change? Make a plot comparing actual and fitted yields and interpret the results of your model.<a href="weather-and-corn-yield-regressions.html#question-4-panel-one-way-to-leverage-multiple-time-series-is-to-group-all-data-into-what-is-called-a-panel-regression.-convert-the-county-id-code-countyfp-or-county_ansi-into-factor-using-as.factor-then-include-this-variable-in-a-regression-using-all-counties-yield-and-summer-temperature-data.-how-does-the-significance-of-your-temperature-coefficients-tmax-tmax2-change-make-a-plot-comparing-actual-and-fitted-yields-and-interpret-the-results-of-your-model." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="weather-and-corn-yield-regressions.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect all summer data</span></span>
<span id="cb92-2"><a href="weather-and-corn-yield-regressions.html#cb92-2" aria-hidden="true" tabindex="-1"></a>summer_tmax <span class="ot">&lt;-</span> tmaxdf <span class="sc">%&gt;%</span></span>
<span id="cb92-3"><a href="weather-and-corn-yield-regressions.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(doy <span class="sc">&gt;=</span> <span class="dv">152</span> <span class="sc">&amp;</span> doy <span class="sc">&lt;=</span> <span class="dv">243</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-4"><a href="weather-and-corn-yield-regressions.html#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(countyfp) <span class="sc">%&gt;%</span>  </span>
<span id="cb92-5"><a href="weather-and-corn-yield-regressions.html#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meantmax =</span> <span class="fu">mean</span>(tmax))</span>
<span id="cb92-6"><a href="weather-and-corn-yield-regressions.html#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="weather-and-corn-yield-regressions.html#cb92-7" aria-hidden="true" tabindex="-1"></a>corn_Y <span class="ot">&lt;-</span> cornyieldsall <span class="sc">%&gt;%</span></span>
<span id="cb92-8"><a href="weather-and-corn-yield-regressions.html#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(county_name) <span class="sc">%&gt;%</span></span>
<span id="cb92-9"><a href="weather-and-corn-yield-regressions.html#cb92-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county_ansi, county_name, yield, year) <span class="sc">%&gt;%</span></span>
<span id="cb92-10"><a href="weather-and-corn-yield-regressions.html#cb92-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(county_ansi) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(yield))</span>
<span id="cb92-11"><a href="weather-and-corn-yield-regressions.html#cb92-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-12"><a href="weather-and-corn-yield-regressions.html#cb92-12" aria-hidden="true" tabindex="-1"></a>summer_tmax<span class="sc">$</span>county_ansi <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(summer_tmax<span class="sc">$</span>countyfp)</span>
<span id="cb92-13"><a href="weather-and-corn-yield-regressions.html#cb92-13" aria-hidden="true" tabindex="-1"></a>corn_Y<span class="sc">$</span>county_ansi <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(corn_Y<span class="sc">$</span>county_ansi)</span>
<span id="cb92-14"><a href="weather-and-corn-yield-regressions.html#cb92-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-15"><a href="weather-and-corn-yield-regressions.html#cb92-15" aria-hidden="true" tabindex="-1"></a>summer_tmax<span class="sc">$</span>tmaxsq <span class="ot">&lt;-</span> summer_tmax<span class="sc">$</span>meantmax<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb92-16"><a href="weather-and-corn-yield-regressions.html#cb92-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-17"><a href="weather-and-corn-yield-regressions.html#cb92-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Use yield_2018, join with summer_tmax^2</span></span>
<span id="cb92-18"><a href="weather-and-corn-yield-regressions.html#cb92-18" aria-hidden="true" tabindex="-1"></a>iowa_YT <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(corn_Y, summer_tmax, <span class="at">by =</span> <span class="st">&quot;county_ansi&quot;</span>)</span>
<span id="cb92-19"><a href="weather-and-corn-yield-regressions.html#cb92-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-20"><a href="weather-and-corn-yield-regressions.html#cb92-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Add &quot;+&quot; to linear model for all yields, add the as.factor column = county_ansi</span></span>
<span id="cb92-21"><a href="weather-and-corn-yield-regressions.html#cb92-21" aria-hidden="true" tabindex="-1"></a>panel_YT <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> county_ansi <span class="sc">+</span> meantmax <span class="sc">+</span> tmaxsq <span class="sc">+</span> year, iowa_YT)</span>
<span id="cb92-22"><a href="weather-and-corn-yield-regressions.html#cb92-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-23"><a href="weather-and-corn-yield-regressions.html#cb92-23" aria-hidden="true" tabindex="-1"></a>iowa_YT<span class="sc">$</span>panelfit <span class="ot">&lt;-</span> panel_YT<span class="sc">$</span>fitted.values <span class="sc">-</span> <span class="dv">100</span></span>
<span id="cb92-24"><a href="weather-and-corn-yield-regressions.html#cb92-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-25"><a href="weather-and-corn-yield-regressions.html#cb92-25" aria-hidden="true" tabindex="-1"></a><span class="co"># I struggled to find a good regression and functioning linear model based upon the model posted in code help.</span></span>
<span id="cb92-26"><a href="weather-and-corn-yield-regressions.html#cb92-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-27"><a href="weather-and-corn-yield-regressions.html#cb92-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iowa_YT, <span class="fu">aes</span>(yield, panelfit)) <span class="sc">+</span> </span>
<span id="cb92-28"><a href="weather-and-corn-yield-regressions.html#cb92-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;darkgoldenrod1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb92-29"><a href="weather-and-corn-yield-regressions.html#cb92-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(yield, panelfit), <span class="at">color =</span> <span class="st">&quot;green4&quot;</span>) <span class="sc">+</span></span>
<span id="cb92-30"><a href="weather-and-corn-yield-regressions.html#cb92-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb92-31"><a href="weather-and-corn-yield-regressions.html#cb92-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Comparison of Corn Yield to Mean Annual Max Temperature, </span><span class="sc">\n</span><span class="st">All Iowa Counties [Panel Regression]&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Mean Summer Max Temperature (C)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Yield&quot;</span>)</span></code></pre></div>
<p><img src="580A7-Bookdown_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
</div>
<div id="question-5-soybeans-download-nass-data-on-soybean-yields-and-explore-either-a-time-series-relationship-for-a-given-county-the-cross-sectional-relationship-for-a-given-year-or-a-panel-across-all-counties-and-years." class="section level3 hasAnchor" number="6.2.6">
<h3><span class="header-section-number">6.2.6</span> Question 5 – Soybeans: Download NASS data on soybean yields and explore either a time series relationship for a given county, the cross-sectional relationship for a given year, or a panel across all counties and years.<a href="weather-and-corn-yield-regressions.html#question-5-soybeans-download-nass-data-on-soybean-yields-and-explore-either-a-time-series-relationship-for-a-given-county-the-cross-sectional-relationship-for-a-given-year-or-a-panel-across-all-counties-and-years." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="weather-and-corn-yield-regressions.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding the soybean parameter</span></span>
<span id="cb93-2"><a href="weather-and-corn-yield-regressions.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co"># nassqs_param_values(&quot;commodity_desc&quot;)</span></span>
<span id="cb93-3"><a href="weather-and-corn-yield-regressions.html#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="weather-and-corn-yield-regressions.html#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters to query on [Jefferson county, 2000 to present]</span></span>
<span id="cb93-5"><a href="weather-and-corn-yield-regressions.html#cb93-5" aria-hidden="true" tabindex="-1"></a>param_soy <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">commodity_desc =</span> <span class="st">&quot;SOYBEANS&quot;</span>, <span class="at">prodn_practice_desc =</span> <span class="st">&quot;ALL PRODUCTION PRACTICES&quot;</span>, <span class="at">year__GE =</span> <span class="dv">2000</span>, <span class="at">state_alpha =</span> <span class="st">&quot;IA&quot;</span>, <span class="at">county_ansi =</span> <span class="st">&quot;101&quot;</span>)</span>
<span id="cb93-6"><a href="weather-and-corn-yield-regressions.html#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="weather-and-corn-yield-regressions.html#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Download dataset</span></span>
<span id="cb93-8"><a href="weather-and-corn-yield-regressions.html#cb93-8" aria-hidden="true" tabindex="-1"></a>soyyieldsjeff <span class="ot">&lt;-</span> <span class="fu">nassqs_yields</span>(param_soy)</span></code></pre></div>
<pre><code>## 
  |                                                                                                          
  |                                                                                                    |   0%
  |                                                                                                          
  |=============================                                                                       |  29%
  |                                                                                                          
  |=======================================================================                             |  71%
  |                                                                                                          
  |====================================================================================================| 100%</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="weather-and-corn-yield-regressions.html#cb95-1" aria-hidden="true" tabindex="-1"></a>soyyieldsjeff<span class="sc">$</span>Value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(soyyieldsjeff<span class="sc">$</span>Value)</span>
<span id="cb95-2"><a href="weather-and-corn-yield-regressions.html#cb95-2" aria-hidden="true" tabindex="-1"></a>soyyieldsjeff<span class="sc">$</span>yield <span class="ot">&lt;-</span> soyyieldsjeff<span class="sc">$</span>Value</span>
<span id="cb95-3"><a href="weather-and-corn-yield-regressions.html#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the dataset</span></span>
<span id="cb95-4"><a href="weather-and-corn-yield-regressions.html#cb95-4" aria-hidden="true" tabindex="-1"></a>cornyields <span class="ot">&lt;-</span> <span class="fu">select</span>(cornyieldsall, county_ansi, county_name, yield, year) <span class="sc">%&gt;%</span></span>
<span id="cb95-5"><a href="weather-and-corn-yield-regressions.html#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(county_ansi) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(yield))</span>
<span id="cb95-6"><a href="weather-and-corn-yield-regressions.html#cb95-6" aria-hidden="true" tabindex="-1"></a>cornyields <span class="ot">&lt;-</span> <span class="fu">tibble</span>(cornyields)</span>
<span id="cb95-7"><a href="weather-and-corn-yield-regressions.html#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="weather-and-corn-yield-regressions.html#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(soyyieldsjeff, <span class="fu">aes</span>(year, yield)) <span class="sc">+</span> </span>
<span id="cb95-9"><a href="weather-and-corn-yield-regressions.html#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;darkgoldenrod1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb95-10"><a href="weather-and-corn-yield-regressions.html#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">color =</span> <span class="st">&quot;green4&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb95-11"><a href="weather-and-corn-yield-regressions.html#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Average Annual Soybean Yield in Jefferson, Iowa [Linear Fit]&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Yield&quot;</span>)</span></code></pre></div>
<p><img src="580A7-Bookdown_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>We can see a trend of increasing yield with each year. This makes since as a trend since populations and demand steadily increases over time. Additionally, the yield may be greater from improved farming technology.</p>
</div>
<div id="bonus-find-a-package-to-make-a-county-map-of-iowa-displaying-some-sort-of-information-about-yields-or-weather.-interpret-your-map." class="section level3 hasAnchor" number="6.2.7">
<h3><span class="header-section-number">6.2.7</span> Bonus: Find a package to make a county map of Iowa displaying some sort of information about yields or weather. Interpret your map.<a href="weather-and-corn-yield-regressions.html#bonus-find-a-package-to-make-a-county-map-of-iowa-displaying-some-sort-of-information-about-yields-or-weather.-interpret-your-map." class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="bonus-2-challenge-question---map-trends-in-corn-yields-by-county-across-iowa.-interpret-your-map." class="section level3 hasAnchor" number="6.2.8">
<h3><span class="header-section-number">6.2.8</span> Bonus #2: Challenge question - map trends in corn yields by county across Iowa. Interpret your map.<a href="weather-and-corn-yield-regressions.html#bonus-2-challenge-question---map-trends-in-corn-yields-by-county-across-iowa.-interpret-your-map." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Run linear model for each, grab increase (slope). Combine county value with slope, display map by counties // increase. red for (-), yellow for (0), green for (+).</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lake-water-quality-analysis.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
